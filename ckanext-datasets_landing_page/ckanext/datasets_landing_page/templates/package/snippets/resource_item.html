{% set url_action = 'resource_edit' if url_is_edit and can_edit else 'resource_read' %}
{% set url = h.url_for(controller='package', action=url_action, id=pkg.name, resource_id=res.id) %}


{# This css style adapts the display of the resources depending if they are displayed in the
  Dataset Landing Page or in the dataset-->manage-->resources page.#}
{% if url_is_edit %}
  <style>
    .resource-item .description {
      position: relative;
      left:60px;
    }
  
    .resource-item:hover {
      background:none
    }
  </style>

  <div>

  {% else %}
    <style>
      .resource-item .description {
        position: relative;
        left:78px;
      }
    
      .resource-item:hover {
        background:none
      }
    </style>
  {% endif %}

<span class="resource-item" data-id="{{ res.id }}">
  {% block resource_item_title %}
  <a class="heading" href="{{ url }}" title="{{ res.name or res.description }}">
    {{ h.resource_display_name(res) | truncate(50) }}<span class="format-label" property="dc:format" data-format="{{ res.format.lower() or 'data' }}">{{ h.get_translated(res, 'format') }}</span>
    {{ h.popular('views', res.tracking_summary.total, min=10) }}
  </a>
  {% endblock %}
  {% block resource_item_description %}
    <p class="description">
      {% if res.description %}
        {{ h.markdown_extract(h.get_translated(res, 'description'), extract_length=80) }}
      {% endif %}
    </p>
  {% endblock %}
  </span>

{% if url_is_edit %}
  </div>
{% endif %}