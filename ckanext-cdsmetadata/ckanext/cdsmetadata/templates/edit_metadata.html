{% extends "page.html" %}
{% import 'macros/form.html' as form %}
{% set errors = errors or {} %}
{% set template_name = g.template_name %}

{% block subtitle %}{{ _('Metadata editor') }}{% endblock %}

{% block head_extras -%}
  {{ super() }}
{% endblock -%}

{% block content_action %}
  {# <em>Content action</em> #}
{% endblock %}

{% block content_primary_nav %} 
  {{ h.build_nav_icon('edit_dataformat', _('DataFormat')) }}  
  {{ h.build_nav_icon('edit_license', _('License')) }}   
  {{ h.build_nav_icon('edit_publication', _('Publication')) }}
  {{ h.build_nav_icon('edit_person', _('Person')) }} 
{% endblock %} 

{% block primary_content_inner %}
  {{ super()}}

  {% block errors %}{{ form.errors(error_summary) }}{% endblock %}

  {% block dataformat_subheading %} {% endblock %}

  {% block metadata_list %}
    <div class="list-group pre-scrollable col-sm-4">
      
      <p> <em>Select from list, or &lt;<em>New</em>&gt to insert new item.</em></p>
      <li class="list-group-item">
        <a href={{ h.url_for(template_name, new=true) }}>&lt;<em>New</em>&gt;</a>
      </li>
      
      {% for item in g.items %}
        <li class="list-group-item">
          <a href={{ h.url_for(template_name, id=item[0]) }} > {{ item[1] }} </a>
        </li>
      {% endfor %}
    </div>
  {% endblock %}

  {% if g.pkg_dict['new'] or g.pkg_dict['id'] %}

    {% set item_id = g.pkg_dict['id'] or '' %} 

    <form id=template_name class="dataset-form col-sm-6" method="post"
          action={{h.url_for(template_name)}} data-module="basic-form">
    
          {% block metadata_form_fields %}{% endblock %}
          
          <div class="form-actions">
            <a class="btn btn-danger pull-left"
               href={{h.url_for(template_name, delete=true, id=item_id) }}
               data-module="confirm-action"
               data-module-content="{{_("Are you sure you want to delete this item?")}}">
               {{_('Delete')}}
            </a>
            <button class="btn btn-primary"
                    name="save"
                    value="{{item_id}}"
                    type="submit">
                    {{_('Submit')}}
            </button>
          </div>
    </form>
  {% endif %}
  
{% endblock %}

{% block secondary_content %}

  {% snippet "snippets/metadata_helper.html" %}

  {% block secondary_help_content %}{% endblock %}
  
{% endblock %}
